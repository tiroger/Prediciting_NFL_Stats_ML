{% extends "layout.html" %} {% block content %}
<div class="container" id="model-build">
  <h2>Building the Model</h2>
  <div id="container">
    <img
      src="https://pngimage.net/wp-content/uploads/2018/06/machine-learning-png.png"
      alt="machine brain"
      style="float: right; width:288px;height:262px;"
    />
    <p>
      The data set used for our model contains a detailed play-by-play account
      of every single play ran over the course of 10 season. It contains,
      geographical and date information, the type of play that was called, the
      number of yeards gained from said play, down, clock and field positioning,
      among others. It also contains offensive stats on each player directly
      involved in the play, such as passing and rushing yards, yards ran after a
      catch, etc, and defensive stats, such as fumbles and interceptions, and of
      course play outcome, e.g. touchdown, field goal, etc.
    </p>
  </div>

  <p>
    In order to create a model that can predict which play is the likeliest to
    be called, we resonned that any information relating to the state prior to
    calling the play would be critical in informing the decision to run a pass
    or a run play, or alternatively to kick a field goal or punt. We limited our
    predictions to either pass or run plays for several reasons:
  </p>

  <ol>
    <li class="features" style="padding-bottom: 16px;">
      Kickoffs were removed as they only occur at the beginning of the game/half
      or after a scoring drive. Decisions don't factor in other then the type of
      kick, e.g. long, short or onside kick.
    </li>
    <li class="features" style="padding-bottom: 16px;">
      Edge cases, such as QB kneel or spiking where also dropped as occur under specific circumstances.
    </li>
    <li class="features" style="padding-bottom: 16px;">
      Punts and field goals occur almost exclusively on 4th down and the decision to run
      either play is largely determined by field positioning.
    </li>
  </ol>

  <div class="row">
  <div class="col-sm-6">
    <h5>Before</h5>
    <div>
    <iframe width="500px" height="500px" frameborder="0" scrolling="no" src="//plot.ly/~rogerlefort/4.embed?showlink=false"></iframe>
</div>
  </div>
  <div class="col-sm-6">
    <h5>After</h5>
    <div>
    <iframe width="500px" height="500px" frameborder="0" scrolling="no" src="//plot.ly/~rogerlefort/59.embed?showlink=false"></iframe>
</div>

  </div>
  </div>
<br>
  <h3>Feature Selection</h3>
  <p>
    The original dataset contains 254! features. After cleaning the data and supplementing with weather information, we focused on features which, as discussed above, which would be predicted to influence play calling.
  </p>
  <h4>Intrinsic Features</h4>
  <p>
    The goal of a play is to gain as many yards as possible, 10 at a minimum,
    generally over the course of 3 downs. As such we would expect down and
    distance to go to be critical in deciding which play to call. Passes
    net more yards on average, but short distances are typically easier to obtain
    running the ball. Time remaining in the half or in the game and score differential are
    also a crucial considerations. Finally, we reasoned that field positioning
    could be important, but largely dependent on other factors, such as time
    remaining and the number of time outs a team possesses, which we also
    included as our inital set of feature:
  </p>
  <ul>
    <li class="features" style="padding-bottom: 16px;">Yard line (yardline_100)</li>
    <li class="features" style="padding-bottom: 16px;">Quarter (qtr)</li>
    <li class="features" style="padding-bottom: 16px;">Time remaining in the half (half_seconds_remaining)</li>
    <li class="features" style="padding-bottom: 16px;">Time remaining in the game (game_seconds_remaining)</li>
    <li class="features" style="padding-bottom: 16px;"> Current down (down)</li>
    <li class="features" style="padding-bottom: 16px;">Yards-to-go to 1st down or TD (ydstogo)</li>
    <li class="features" style="padding-bottom: 16px;">Timeouts remaing, possession team (posteam_timeouts_remaining)</li>
    <li class="features" style="padding-bottom: 16px;">Timeouts remaing, defending team (defteam_timeouts_remaining)</li>
    <li class="features" style="padding-bottom: 16px;">Score differential (score_differential)</li>
  </ul>

  <h4>Extrinsic Features</h4>
  <p>
    As discussed earlier, weather plays a critical part in deciding which play to call. For example, under heavy rains or strong winds, loss of grip and visibility may favor running plays. We sought out to detemine whether weather conditions could improve our learning model. The following game time weather parameters were included:
  </p>
  <ul>
    <li class="features" style="padding-bottom: 16px;">Temperature</li>
    <li class="features" style="padding-bottom: 16px;">Precipitation (amount)</li>
    <li class="features" style="padding-bottom: 16px;">Snow (amount)</li>
    <li class="features" style="padding-bottom: 16px;">Wind speeds</li>
    <li class="features" style="padding-bottom: 16px;">Visibility</li>
    <li class="features" style="padding-bottom: 16px;">Humidity</li>
  </ul>

  <p>
    To facilitate the exploratory data analysis phase, we used the extremely useful library, <a class= 'hyperlink' href='https://github.com/pandas-profiling/pandas-profiling'>pandas_profiling</a>.
  </p>

  <p>For each feature in our dataset, the following statistics - if relevant for the column type - were obtained --available in an interactive <a class='hyperlink' href='/feature-profile'>HTML report</a>:</p>
<ul>
  <li class="features" style="padding-bottom: 16px;"><b>Essentials</b>: type, unique values, missing values</li>
  <li class="features" style="padding-bottom: 16px;"><b>Quantile statistics</b> like minimum value, Q1, median, Q3, maximum, range, interquartile range</li>
  <li class="features" style="padding-bottom: 16px;"><b>Descriptive statistics</b> like mean, mode, standard deviation, sum, median absolute deviation, coefficient of variation, kurtosis, skewness</li>
  <li class="features" style="padding-bottom: 16px;"><b>Most frequent values</b></li>
  <li class="features" style="padding-bottom: 16px;"><b>Histogram</b></li>
  <li class="features" style="padding-bottom: 16px;"><b>Correlations</b> highlighting of highly correlated variables, Spearman and Pearson matrixes</li>
</ul>
<p>None of the features we intuitively selected showed any significant correlation. However, a number of features include several outliers.</p>
<div>
<!-- <iframe id="iframe" src="/box-plot" width="800px" height="500px" scrolling="no" frameborder="0"></iframe> -->
</div>
  <div class="line"></div>

  <h4>Models</h4>
  <p>
    Our decision to limit the play types reduced this to a classification: Given a set of pre-existing game and weather conditions, what is the predicted play call. After cleaning and aggregating the data, we ran multiple algorithms:
  </p>
  <ul>
    <li class="features" style="padding-bottom: 16px;">Logistic Regression</li>
    <li class="features" style="padding-bottom: 16px;">Bagging meta-estimator</li>
    <li class="features" style="padding-bottom: 16px;">AdaBoost</li>
    <li class="features" style="padding-bottom: 16px;">XGBoost</li>
    <li class="features" style="padding-bottom: 16px;">Decision Tree</li>
    <li class="features" style="padding-bottom: 16px;">Random Forest</li>
  </ul>

  <div class="line"></div>


  <div class="dropdown"></div>
  <div id="dropdown-viz"></div>

  <!-- <div id="container">


  <script type='text/javascript' src='https://prod-useast-a.online.tableau.com/javascripts/api/viz_v1.js'></script>
  <div class='tableauPlaceholder' style='width: 1200px; height: 647px;'><object class='tableauViz' width='1200' height='647' style='display:none;'><param name='host_url' value='https%3A%2F%2Fprod-useast-a.online.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='&#47;t&#47;rogerlefort' /><param name='name' value='ModelScores&#47;Sheet2' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='showAppBanner' value='false' /><param name='filter' value='iframeSizedToWindow=true' /></object></div> -->


  </div>

<div class="line"></div>

<script type='text/javascript' src='https://prod-useast-a.online.tableau.com/javascripts/api/viz_v1.js'></script><div class='tableauPlaceholder' style='width: 1200px; height: 552px;'><object class='tableauViz' width='1200' height='552' style='display:none;'><param name='host_url' value='https%3A%2F%2Fprod-useast-a.online.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='&#47;t&#47;rogerlefort' /><param name='name' value='Weather&#47;Sheet2' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='showAppBanner' value='false' /><param name='filter' value='iframeSizedToWindow=true' /></object></div>

<div class="line"></div>

<script type='text/javascript' src='https://prod-useast-a.online.tableau.com/javascripts/api/viz_v1.js'></script><div class='tableauPlaceholder' style='width: 1200px; height: 552px;'><object class='tableauViz' width='1200' height='552' style='display:none;'><param name='host_url' value='https%3A%2F%2Fprod-useast-a.online.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='&#47;t&#47;rogerlefort' /><param name='name' value='Featureimportace&#47;Sheet1' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='showAppBanner' value='false' /><param name='filter' value='iframeSizedToWindow=true' /></object></div>

<div class="line"></div>




  <div id="container">



    <!-- <script>
    var modelScores = ["Train Score", "Test Score"];
    var url = "/scores";
    var promise = d3.json(url);

    // Getting data from table route
    promise.then(function(data){
      // console.log(data);

    	// create the drop down menu of cities
    	var selector = d3.select("body")
    		.append("select")
    		.attr("id", "model")
    		.selectAll("option")
    		.data(data)
    		.enter().append("option")
    		.text(function(d) { return d.model; })
    		.attr("value", function (d, i) {
    			return i;
          console.log(d.model)
    		});
        // generate a random index value and set the selector to the city
      // at that index value in the data array
      var index = Math.round(Math.random() * data.length);
      d3.select("#model").property("selectedIndex", index);

      // append a paragraph tag to the body that shows the city name and it's population
      d3.select("body")
            .append("p")
            .data(data)
            .text(function(d){
              return data[index]['train_score'];
            })

      });
    </script> -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
  </div>

  <div class="line"></div>



</div>

<!-- My Scripts -->
<script src="{{ url_for('static', filename='js/barChart.js') }}"></script>
<!-- D3 I HATE YOU! -->
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
{% endblock %}
